---
import { Image } from "astro:assets";
import { getCollection } from "astro:content";
import BaseLayout from "../components/base.astro";

const projects = await getCollection("projects");
const sides = await getCollection("sides");
---

<BaseLayout title='Case Studies'>
  <section class='flow'>
    <h1>Case Studies</h1>

    <div class='grid'>
      <div class='flow'>
        <h2>Client Work</h2>
        <ul class='flow'>
          {
            projects.map(project => (
              <li>
                <a class='card' href={`/case-studies/${project.slug}`}>
                  <Image
                    src={project.data.image}
                    alt={`${project.data.title} hero image`}
                  />
                  <div class='flow'>
                    <h3>{project.data.title}</h3>
                    <p>
                      <strong>Client:</strong> {project.data.client}
                    </p>
                  </div>
                </a>
              </li>
            ))
          }
        </ul>
      </div>
      <div class='flow'>
        <h2>On The Side</h2>
        <ul class='flow'>
          {
            sides.map(side => (
              <li class='card'>
                <Image
                  src={side.data.image}
                  alt={`${side.data.title} hero image`}
                />
                <div class='flow'>
                  <h3>{side.data.title}</h3>
                  <p>
                    {side.render().then(({ Content }) => (
                      <Content />
                    ))}
                  </p>
                  <a href={side.data.link}>View Project</a>
                </div>
              </li>
            ))
          }
        </ul>
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  @media (min-width: 50em) {
    section > div {
      --grid-columns: 1fr 1fr;
    }
  }

  .card {
    display: block;
    background-color: var(--colour-primary);
    color: var(--colour-secondary);
    box-shadow: 0 8px 16px hsl(0 0% 0% / 0.1);
    border-radius: var(--radius);
    overflow: hidden;
  }

  .card > div {
    padding: 1.2rem 2rem;
  }

  .card img {
    max-height: 14rem;
  }
</style>
